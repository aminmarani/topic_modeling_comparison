<!DOCTYPE html>
<html>
<head>
  <title>Topical Visualization</title>
<style>
img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="node_modules/leader-line/leader-line.min.js"></script>
<script>
var topic_data;
const arr = [[],[],[],[],[],[],[]];





$(document).ready(function(){

  $.getJSON( "topics.json", function( data ) {
  // Do something with the JSON data
   for (var i = 0;i<3;i++)
   {
      $("#div"+i).width(400);
      $("#div"+i).height(400);
      $("#div"+i).fadeIn(i*1000);

      //adding texts and images
      var img=document.createElement("img");
      img.src=data['topic '+i][4];
      img.width = 200
      img.height = 200
      // img
      $("#div"+i).append(img)

      // text
      if (data['topic '+i][2].length>500)
      {
        $("#div"+i).append("\n"+ data['topic '+i][2].substring(0,500)+'<a href="'+data['topic '+i][3]+'"> ...read more.</a>')
         // <a href="https://www.w3schools.com">...read more...</a>')
      }
      else
      {
        $("#div"+i).append("\n"+ data['topic '+i][2].substring(0,500))
      }


      $("#div"+i).append('<input type="button" id="button' + i + '" value=" Show me more!" onclick="myFunction(this)"/>')
      // $("#button"+i).click(function(e)
      // {
      //   var l=-1;
      //   alert("Show me more!"+l)
      // });

    }
});
// $.getJSON( "transitions.json", function( data ) {
//         for (var i=0;i<3;i++)
//         {
//           var l=-1;
//           l = data['topic '+i].length
//           $("#button"+i).click(function(e)
//           {  
//             console.log(i)
//             alert("Show me more!"+data['topic '+i][0][0])
//           });
//         }
//         });


});

function myFunction(elem) {
    var trans;
    $.getJSON( "transitions.json", function( data ) {

      id = elem.id.split('button')[1]
      var topic = 'topic '+ id
      base_left = 500
      for (var i=0;i<data[topic].length;i++)
      {
        var div = document.createElement("div");
        div.setAttribute("id","div"+id+"div"+i)
        div.style.width = "200px";
        div.style.height = 400-40*(3-i)+"px";
        div.style.background = "#7393B3";
        div.style.color = "white";
        div.innerHTML = '<img src="'+data[topic][i][1]+'" width="200" height="200">' +data[topic][i][0]
        div.style.position = "absolute";
        div.style.left = base_left + "px"
        base_left += 210
        div.style.top = 40*(3-i)+75 + (400*id)+((id+1)*2.5)+"px" 
        document.getElementById("div"+id).appendChild(div)

        // drawing a line
        if (arr[id].length < 3)
        {
          var line =  new LeaderLine(
          LeaderLine.pointAnchor(document.getElementById('div'+id), {x: "100%", y: 30+(40)*(2-i)}),
          LeaderLine.pointAnchor(document.getElementById('div'+id+'div'+i), {x: 0, y: 0}),
          {dash: {animation: true}}
          );
          arr[id][i] = line
        }
        else
        {
          arr[id][i].remove()
          var line =  new LeaderLine(
          LeaderLine.pointAnchor(document.getElementById('div'+id), {x: "100%", y: 30+(40)*(2-i)}),
          LeaderLine.pointAnchor(document.getElementById('div'+id+'div'+i), {x: 0, y: 0}),
          {outline: false,color: 'blue',endPlugOutline: true,size:20*data[topic][i][2],endlabel: LeaderLine.captionLabel({text: 'LABEL-2', color: 'red'})}
          );
          
        }
      }

    // new LeaderLine(
    //     document.getElementById('div1'),
    //     document.getElementById('div1div1'),
    //     {color: 'red', size: 8}
    //   );


    });
    
}


</script>
</head>
<body>

<div id="div_exp" style="width:1200px;height:50px;display:True;background-color:#818593;">
  
  <h5> These are posts from users writing about ED and ED recovery. 
  <br>
  <br>
  Think about a moment in the past and choose one or more post to explore that aligned with that moment.
</h5>
</div><br>

<!-- <button>Start...</button><br><br> -->
<div id="div0" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div1" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div2" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div3" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div4" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div5" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div6" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div7" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div8" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div9" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div10" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div11" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div12" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div13" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>
<div id="div14" style="width:300px;height:300px;display:none;background-color:#bfcfff;"></div><br>

</body>
</html>
